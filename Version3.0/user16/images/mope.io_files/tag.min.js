(function() {
	// settings AdinPlay
	window.aiptag = window.aiptag || {cmd: []};
	aiptag.cmd.display = aiptag.cmd.display || [];
	aiptag.cmd.player = aiptag.cmd.player || [];
	aiptag.cmd.queue = aiptag.cmd.queue || [];
	aiptag.cmd.load = aiptag.cmd.load || [];
	aiptag.cmp = aiptag.cmp || {};

	var adinplayPercentage = 91;
	var prosperPercentage = 9;
	var aipPubId = "LBS/mope.io";
	var aipDomain = "mope.io";
	var queryParams = getQueryStringParams();

	function getQueryStringParams() {
		var params = {};
		var queryString = window.location.search.substring(1);
		var pairs = queryString.split("&");
		for (var i = 0; i < pairs.length; i++) {
			var pair = pairs[i].split("=");
			var key = decodeURIComponent(pair[0]);
			var value = decodeURIComponent(pair[1]);
			params[key] = value;
		}
		return params;
	}

	if (queryParams.tag === 'legacy-aip') {
		adinplayPercentage = 100;
		prosperPercentage = 0;
	} else if (queryParams.tag === 'prosper') {
		adinplayPercentage = 0;
		prosperPercentage = 100;
	}

	const randomNumber = Math.floor(Math.random() * 100);
	if (randomNumber < prosperPercentage) {
		var script = document.createElement('script');
		script.src = 'https://api.adinplay.com/libs/aiptag/pub/'+aipPubId+'/tag.pr.min.js';
		document.head.appendChild(script);
		try {
			window.aiptag.stack = "prosper";
		}catch(e){}
	} else {
		var script = document.createElement('script');
		script.src = 'https://api.adinplay.com/libs/aiptag/pub/'+aipPubId+'/tag.aip.min.js';
		document.head.appendChild(script);
		try {
			window.aiptag.stack = "legacy-aip";
		}catch(e){}
	}
})();